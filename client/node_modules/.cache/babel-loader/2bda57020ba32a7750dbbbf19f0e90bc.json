{"ast":null,"code":"//1-importing axios\nimport axios from 'axios'; //9-importing the fn. that will handle our errors\n\nimport { returnErrors } from './errorActions'; //2-importing the types need it\n\nimport { USER_LOADING, USER_LOADED, AUTH_ERROR, LOGIN_SUCCESS, LOGIN_FAIL, LOGOUT_SUCCESS, REGISTER_SUCCESS, REGISTER_FAIL } from './types'; //3-Check token & load user\n\n/** madémna bch nésta3mlolu an async. call lézém nesta3méll él dispatch  \n *  I want to be able to get parts of the state méllé5er 7achti bél token éli houa mawjoud él state\n *  along with dispatch bch n3adi une fn. esmha getState té5ouli él attr. éli 7achti bih mél state\n *  don't forget to wrap dispatch 1st param and getState 2sec param in parentheses\n */\n\nexport const loadUser = () => (dispatch, getState) => {\n  //houni 3adina getState 5ater 3ana access él state of redux\n  //fn. body                                          //c'est le syxtaxe kiféch i access the state mél actions bté3i\n  //4-dispatch user loading 5ater bch njibou mél DB\n  //User loading\n  dispatch({\n    type: USER_LOADING\n  }); //we wanna do that b4 anything\n  //8-fetching the user\n\n  axios.get('/api/auth/user', tokenConfig(getState)) //zédna 3adina él headers éli zédnéhom lél req\n  .then(res => dispatch({\n    type: USER_LOADED,\n    payload: res.data //this object contains the user object +token éli nraj3ou fih mél server\n\n  })) //if there is an issue\n  .catch(err => {\n    dispatch(returnErrors(err.response.data, err.response.status));\n    dispatch({\n      type: AUTH_ERROR\n    });\n  });\n}; //Register User action\n\nexport const register = ({\n  name,\n  email,\n  password\n}) => dispatch => {\n  //houni bch nab3thou post req. to the server to register the user\n  //Steps\n  //1-Headers of the req.\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  }; //2-Req. Body or the Req. Data that we're going to send to the server (éli hiya bch tkoune name, email and password)\n\n  const body = JSON.stringify({\n    name,\n    email,\n    password\n  }); //esta3malna this method 5ater we're taking a JS object that we want to turn it into JSON Data\n  //3-we are ready to make our Req.\n\n  axios.post('/api/users', body, config).then(res => dispatch({\n    type: REGISTER_SUCCESS,\n    //everything went ok and the user was created\n    payload: res.data //kén nchoufou l api fél serve él response bch tkoune our user object man8ir él pwd + le token all that data is going to the reducer to be set\n\n  })).catch(err => {\n    //if something went wrong\n    //i wanna dispatch 2 things\n    //tawa i wanna use the return errors that we created\n    //to dipslay to the user the errors\n    dispatch(returnErrors(err.response.data, err.response.status, 'REGISTER_FAIL'));\n    dispatch({\n      type: REGISTER_FAIL\n    });\n  });\n}; //Login User\n\nexport const login = ({\n  email,\n  password\n}) => dispatch => {\n  //houni bch nab3thou post req. to the server to login the user\n  //Steps\n  //1-Headers of the req.\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  }; //2-Req. Body or the Req. Data that we're going to send to the server (éli hiya bch tkoune email and password)\n\n  const body = JSON.stringify({\n    email,\n    password\n  }); //esta3malna this method 5ater we're taking a JS object that we want to turn it into JSON Data\n  //3-we are ready to make our Req.\n\n  axios.post('/api/auth', body, config).then(res => dispatch({\n    type: LOGIN_SUCCESS,\n    //everything went ok and the user was created\n    payload: res.data //kén nchoufou l api fél serve él response bch tkoune our user object man8ir él pwd + le token all that data is going to the reducer to be set\n\n  })).catch(err => {\n    //if something went wrong\n    //i wanna dispatch 2 things\n    //tawa i wanna use the return errors that we created\n    //to dipslay to the user the errors\n    dispatch(returnErrors(err.response.data, err.response.status, 'LOGIN_FAIL'));\n    dispatch({\n      type: LOGIN_FAIL\n    });\n  });\n}; // Logout User\n\nexport const logout = () => {\n  //here we don't need our dispatch 5ater ma faméche communication m3a an external api\n  return {\n    // tfaker ke an action return an object !!! with type and payload (optional)\n    type: LOGOUT_SUCCESS\n  };\n};\n/* ------------------------tokenConfig (it's a helper function to get the token)--------------------------------------------------*/\n//Setup config/headers and token\n\nexport const tokenConfig = getState => {\n  //5-Getting the token from local storage\n  const token = getState().auth.token; // !!! esta3malt la fn. getState().name_of_reducer.attr !!!\n  //6-Adding headers to my req. using axios\n\n  const config = {\n    headers: {\n      \"Content-type\": \"application/json\"\n    }\n  }; //7-verify if the toekn exists we will add it to the headers\n\n  if (token) {\n    config.headers['x-auth-token'] = token;\n    /** ya3ni éna 3andi token fél localStorage 7atinéh fél state\n        * zédna 7atina él token éli jébnéh mél localStorage\n          fél headers bta3 él req éli bch tétb3ath lél server*/\n  }\n\n  return config;\n};\n/** 1-our fnc. tokenConfig take the getState as a parameter \n *  5ater getState hiya él fn. éli bch téjbédli él token mél redux state bté3i\n *  2-Now any time we need to send the token to a certain endpoint we just simply call \n *  tokenConfig(getState) like we did in the axios fél star 34 \n *   axios.get('/api/auth/user', tokenConfig(getState))\n * \n *  7ata law in diff. file we just import it 5ater here we are exporting it and then use it\n*/\n\n/* ------------------------end tokenConfig--------------------------------------------------*/","map":{"version":3,"sources":["C:/Users/houss/Downloads/Compressed/MERN_APP-master/MERN_APP-master/client/src/actions/authActions.js"],"names":["axios","returnErrors","USER_LOADING","USER_LOADED","AUTH_ERROR","LOGIN_SUCCESS","LOGIN_FAIL","LOGOUT_SUCCESS","REGISTER_SUCCESS","REGISTER_FAIL","loadUser","dispatch","getState","type","get","tokenConfig","then","res","payload","data","catch","err","response","status","register","name","email","password","config","headers","body","JSON","stringify","post","login","logout","token","auth"],"mappings":"AAAA;AACA,OAAOA,KAAP,MAAkB,OAAlB,C,CAEA;;AACA,SAASC,YAAT,QAA6B,gBAA7B,C,CAEA;;AACA,SACIC,YADJ,EAEIC,WAFJ,EAGIC,UAHJ,EAIIC,aAJJ,EAKIC,UALJ,EAMIC,cANJ,EAOIC,gBAPJ,EAQIC,aARJ,QASO,SATP,C,CAWA;;AAEA;;;;;;AAKA,OAAO,MAAMC,QAAQ,GAAG,MAAM,CAACC,QAAD,EAAWC,QAAX,KAAwB;AAAE;AACpD;AAEA;AACA;AACAD,EAAAA,QAAQ,CAAC;AAAEE,IAAAA,IAAI,EAAEX;AAAR,GAAD,CAAR,CALkD,CAKhB;AAElC;;AACAF,EAAAA,KAAK,CAACc,GAAN,CAAU,gBAAV,EAA4BC,WAAW,CAACH,QAAD,CAAvC,EAAmD;AAAnD,GACKI,IADL,CACUC,GAAG,IAAIN,QAAQ,CAAC;AAClBE,IAAAA,IAAI,EAAEV,WADY;AAElBe,IAAAA,OAAO,EAAED,GAAG,CAACE,IAFK,CAEA;;AAFA,GAAD,CADzB,EAKI;AALJ,GAMKC,KANL,CAMWC,GAAG,IAAI;AACVV,IAAAA,QAAQ,CAACV,YAAY,CAACoB,GAAG,CAACC,QAAJ,CAAaH,IAAd,EAAoBE,GAAG,CAACC,QAAJ,CAAaC,MAAjC,CAAb,CAAR;AACAZ,IAAAA,QAAQ,CAAC;AACLE,MAAAA,IAAI,EAAET;AADD,KAAD,CAAR;AAGH,GAXL;AAYH,CApBM,C,CAsBP;;AACA,OAAO,MAAMoB,QAAQ,GAAG,CAAC;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,KAAR;AAAeC,EAAAA;AAAf,CAAD,KAA+BhB,QAAQ,IAAI;AAC/D;AACA;AACA;AACA,QAAMiB,MAAM,GAAG;AACXC,IAAAA,OAAO,EAAE;AACL,sBAAgB;AADX;AADE,GAAf,CAJ+D,CAU/D;;AACA,QAAMC,IAAI,GAAGC,IAAI,CAACC,SAAL,CAAe;AAAEP,IAAAA,IAAF;AAAQC,IAAAA,KAAR;AAAeC,IAAAA;AAAf,GAAf,CAAb,CAX+D,CAWJ;AAE3D;;AACA3B,EAAAA,KAAK,CAACiC,IAAN,CAAW,YAAX,EAAyBH,IAAzB,EAA+BF,MAA/B,EACKZ,IADL,CACUC,GAAG,IAAIN,QAAQ,CAAC;AAClBE,IAAAA,IAAI,EAAEL,gBADY;AACM;AACxBU,IAAAA,OAAO,EAAED,GAAG,CAACE,IAFK,CAEM;;AAFN,GAAD,CADzB,EAKKC,KALL,CAKWC,GAAG,IAAI;AACV;AACA;AACA;AACA;AACAV,IAAAA,QAAQ,CAACV,YAAY,CAACoB,GAAG,CAACC,QAAJ,CAAaH,IAAd,EAAoBE,GAAG,CAACC,QAAJ,CAAaC,MAAjC,EAAyC,eAAzC,CAAb,CAAR;AAEAZ,IAAAA,QAAQ,CAAC;AACLE,MAAAA,IAAI,EAAEJ;AADD,KAAD,CAAR;AAIH,GAhBL;AAiBH,CA/BM,C,CAiCP;;AACA,OAAO,MAAMyB,KAAK,GAAG,CAAC;AAAER,EAAAA,KAAF;AAASC,EAAAA;AAAT,CAAD,KAAyBhB,QAAQ,IAAI;AACtD;AACA;AACA;AACA,QAAMiB,MAAM,GAAG;AACXC,IAAAA,OAAO,EAAE;AACL,sBAAgB;AADX;AADE,GAAf,CAJsD,CAUtD;;AACA,QAAMC,IAAI,GAAGC,IAAI,CAACC,SAAL,CAAe;AAAEN,IAAAA,KAAF;AAASC,IAAAA;AAAT,GAAf,CAAb,CAXsD,CAWD;AAErD;;AACA3B,EAAAA,KAAK,CAACiC,IAAN,CAAW,WAAX,EAAwBH,IAAxB,EAA8BF,MAA9B,EACKZ,IADL,CACUC,GAAG,IAAIN,QAAQ,CAAC;AAClBE,IAAAA,IAAI,EAAER,aADY;AACG;AACrBa,IAAAA,OAAO,EAAED,GAAG,CAACE,IAFK,CAEM;;AAFN,GAAD,CADzB,EAKKC,KALL,CAKWC,GAAG,IAAI;AACV;AACA;AACA;AACA;AACAV,IAAAA,QAAQ,CAACV,YAAY,CAACoB,GAAG,CAACC,QAAJ,CAAaH,IAAd,EAAoBE,GAAG,CAACC,QAAJ,CAAaC,MAAjC,EAAyC,YAAzC,CAAb,CAAR;AACAZ,IAAAA,QAAQ,CAAC;AACLE,MAAAA,IAAI,EAAEP;AADD,KAAD,CAAR;AAIH,GAfL;AAgBH,CA9BM,C,CAkCP;;AACA,OAAO,MAAM6B,MAAM,GAAG,MAAM;AAAE;AAC1B,SAAM;AAAE;AACJtB,IAAAA,IAAI,EAAEN;AADJ,GAAN;AAGH,CAJM;AAOP;AACA;;AACA,OAAO,MAAMQ,WAAW,GAAGH,QAAQ,IAAI;AACnC;AACA,QAAMwB,KAAK,GAAGxB,QAAQ,GAAGyB,IAAX,CAAgBD,KAA9B,CAFmC,CAEE;AAErC;;AACA,QAAMR,MAAM,GAAG;AACXC,IAAAA,OAAO,EAAE;AACL,sBAAgB;AADX;AADE,GAAf,CALmC,CAWnC;;AACA,MAAIO,KAAJ,EAAW;AACPR,IAAAA,MAAM,CAACC,OAAP,CAAe,cAAf,IAAiCO,KAAjC;AAAwC;;;AAG3C;;AAED,SAAOR,MAAP;AACH,CAnBM;AAqBP;;;;;;;;;AASA","sourcesContent":["//1-importing axios\nimport axios from 'axios';\n\n//9-importing the fn. that will handle our errors\nimport { returnErrors } from './errorActions';\n\n//2-importing the types need it\nimport {\n    USER_LOADING,\n    USER_LOADED,\n    AUTH_ERROR,\n    LOGIN_SUCCESS,\n    LOGIN_FAIL,\n    LOGOUT_SUCCESS,\n    REGISTER_SUCCESS,\n    REGISTER_FAIL\n} from './types';\n\n//3-Check token & load user\n\n/** madémna bch nésta3mlolu an async. call lézém nesta3méll él dispatch  \n *  I want to be able to get parts of the state méllé5er 7achti bél token éli houa mawjoud él state\n *  along with dispatch bch n3adi une fn. esmha getState té5ouli él attr. éli 7achti bih mél state\n *  don't forget to wrap dispatch 1st param and getState 2sec param in parentheses\n */\nexport const loadUser = () => (dispatch, getState) => { //houni 3adina getState 5ater 3ana access él state of redux\n    //fn. body                                          //c'est le syxtaxe kiféch i access the state mél actions bté3i\n\n    //4-dispatch user loading 5ater bch njibou mél DB\n    //User loading\n    dispatch({ type: USER_LOADING }); //we wanna do that b4 anything\n\n    //8-fetching the user\n    axios.get('/api/auth/user', tokenConfig(getState)) //zédna 3adina él headers éli zédnéhom lél req\n        .then(res => dispatch({\n            type: USER_LOADED,\n            payload: res.data //this object contains the user object +token éli nraj3ou fih mél server\n        }))\n        //if there is an issue\n        .catch(err => {\n            dispatch(returnErrors(err.response.data, err.response.status));\n            dispatch({\n                type: AUTH_ERROR\n            });\n        });\n};\n\n//Register User action\nexport const register = ({ name, email, password }) => dispatch => {\n    //houni bch nab3thou post req. to the server to register the user\n    //Steps\n    //1-Headers of the req.\n    const config = {\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    }\n\n    //2-Req. Body or the Req. Data that we're going to send to the server (éli hiya bch tkoune name, email and password)\n    const body = JSON.stringify({ name, email, password });    //esta3malna this method 5ater we're taking a JS object that we want to turn it into JSON Data\n\n    //3-we are ready to make our Req.\n    axios.post('/api/users', body, config)\n        .then(res => dispatch({\n            type: REGISTER_SUCCESS, //everything went ok and the user was created\n            payload: res.data       //kén nchoufou l api fél serve él response bch tkoune our user object man8ir él pwd + le token all that data is going to the reducer to be set\n        }))\n        .catch(err => {\n            //if something went wrong\n            //i wanna dispatch 2 things\n            //tawa i wanna use the return errors that we created\n            //to dipslay to the user the errors\n            dispatch(returnErrors(err.response.data, err.response.status, 'REGISTER_FAIL'));\n            \n            dispatch({\n                type: REGISTER_FAIL\n            });\n\n        });\n};\n\n//Login User\nexport const login = ({ email, password }) => dispatch => {\n    //houni bch nab3thou post req. to the server to login the user\n    //Steps\n    //1-Headers of the req.\n    const config = {\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    }\n\n    //2-Req. Body or the Req. Data that we're going to send to the server (éli hiya bch tkoune email and password)\n    const body = JSON.stringify({ email, password });    //esta3malna this method 5ater we're taking a JS object that we want to turn it into JSON Data\n\n    //3-we are ready to make our Req.\n    axios.post('/api/auth', body, config)\n        .then(res => dispatch({\n            type: LOGIN_SUCCESS, //everything went ok and the user was created\n            payload: res.data       //kén nchoufou l api fél serve él response bch tkoune our user object man8ir él pwd + le token all that data is going to the reducer to be set\n        }))\n        .catch(err => {\n            //if something went wrong\n            //i wanna dispatch 2 things\n            //tawa i wanna use the return errors that we created\n            //to dipslay to the user the errors\n            dispatch(returnErrors(err.response.data, err.response.status, 'LOGIN_FAIL'));\n            dispatch({\n                type: LOGIN_FAIL\n            });\n\n        });\n};\n\n\n\n// Logout User\nexport const logout = () => { //here we don't need our dispatch 5ater ma faméche communication m3a an external api\n    return{ // tfaker ke an action return an object !!! with type and payload (optional)\n        type: LOGOUT_SUCCESS\n    };\n};\n\n\n/* ------------------------tokenConfig (it's a helper function to get the token)--------------------------------------------------*/\n//Setup config/headers and token\nexport const tokenConfig = getState => {\n    //5-Getting the token from local storage\n    const token = getState().auth.token; // !!! esta3malt la fn. getState().name_of_reducer.attr !!!\n\n    //6-Adding headers to my req. using axios\n    const config = {\n        headers: {\n            \"Content-type\": \"application/json\"\n        }\n    }\n\n    //7-verify if the toekn exists we will add it to the headers\n    if (token) {\n        config.headers['x-auth-token'] = token; /** ya3ni éna 3andi token fél localStorage 7atinéh fél state\n                                                    * zédna 7atina él token éli jébnéh mél localStorage\n                                                      fél headers bta3 él req éli bch tétb3ath lél server*/\n    }\n\n    return config;\n}\n\n/** 1-our fnc. tokenConfig take the getState as a parameter \n *  5ater getState hiya él fn. éli bch téjbédli él token mél redux state bté3i\n *  2-Now any time we need to send the token to a certain endpoint we just simply call \n *  tokenConfig(getState) like we did in the axios fél star 34 \n *   axios.get('/api/auth/user', tokenConfig(getState))\n * \n *  7ata law in diff. file we just import it 5ater here we are exporting it and then use it\n*/\n\n/* ------------------------end tokenConfig--------------------------------------------------*/"]},"metadata":{},"sourceType":"module"}